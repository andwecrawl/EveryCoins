# EveryCoins
![ev 001](https://github.com/andwecrawl/Mobbie/assets/120160532/899d8d8f-9f41-4978-82a9-af5634bceb8e)

<br>

## ì•± ì†Œê°œ
ì‹¤ì‹œê°„ìœ¼ë¡œ ì•”í˜¸ í™”íì˜ ê°€ê²©ì„ ë¹ ë¥´ê²Œ í™•ì¸í•˜ê³  ê´€ì‹¬ìˆëŠ” ìƒí’ˆì„ ì§€ê°‘ì—ì„œ í¸ë¦¬í•˜ê²Œ ë³¼ ìˆ˜ ìˆëŠ” ì•±
<br>
<br>
## ê¸°ëŠ¥ ì†Œê°œ
- ì‹¤ì‹œê°„ìœ¼ë¡œ ì•”í˜¸ í™”íì˜ ê°€ê²©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì„¸ë¶€ í•­ëª©ì—ì„œ íŠ¹ì • ì½”ì¸ì˜ í˜¸ê°€ì°½ì„ ë³¼ ìˆ˜ ìˆìœ¼ë©° ì—…ë¹„íŠ¸ ë¡œê·¸ì¸ì„ í†µí•´ ë§¤ìˆ˜/ë§¤ë„ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
  - ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ê³¼ ì• í”Œ ë¡œê·¸ì¸ì„ ì§€ì›í•©ë‹ˆë‹¤.
- ê´€ì‹¬ ìˆëŠ” í•­ëª©ì„ ë‚´ ì§€ê°‘ì— ë“±ë¡ í›„ ë¹ ë¥´ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŠ¹ì • ì½”ì¸ì„ ìœ„ì ¯ìœ¼ë¡œ ë“±ë¡í•˜ì—¬ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>
<br>

## ì‚¬ìš©í•œ ê¸°ìˆ 
- `SwiftUI`, `Combine`, `WidgetKit` , `Charts`
- `Alamofire`, `AuthenticationServices`
- `MVVM`, `Singleton`, `Router` 
<br>
<br>

## ê¸°ëŠ¥ ì†Œê°œ
- **SwiftUIì™€ Combine, MVVM**ì„ ì´ìš©í•˜ì—¬ **ì¸í„°í˜ì´ìŠ¤ì™€ ë¡œì§ì´ ëª…í™•íˆ ë¶„ë¦¬**ëœ **ë°˜ì‘í˜• UI**ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
- **WebSocket** í†µì‹ ì„ ì´ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°ì´í„°ê°€ ë³€í™”í•˜ëŠ” **Listì™€ Bar/Line Charts**ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
- `@Namespace`ì™€ `machedGeometryEffect` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ ì‚¬ìš©ìì˜ Interactionì— ë”°ë¼ ìì—°ìŠ¤ëŸ½ê²Œ ê°ì²´ê°€ ì´ë™í•˜ëŠ” í™”ë©´ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
- 
- Kakao ë¡œê·¸ì¸ê³¼ **AuthenticationServices**ë¥¼ í™œìš©í•˜ì—¬ **Apple ë¡œê·¸ì¸**ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
- WidgetKitì„ ì´ìš©í•˜ì—¬ ì‚¬ìš©ì ì»¤ìŠ¤í…€ì´ ê°€ëŠ¥í•œ `Intent Widget`ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
<br>
<br>

## TroubleShooting
### 1. ì†Œì¼“ í†µì‹ ì´ ì¼ì–´ë‚˜ëŠ” Viewê°€ ìŒ“ì´ë©´ì„œ ì¼ì–´ë‚˜ëŠ” ê³¼ë„í•œ ì†Œì¼“ í†µì‹ 
- ë¬¸ì œ ìƒí™©
  - ì†Œì¼“ í†µì‹ í•˜ëŠ” Viewì—ì„œ í™”ë©´ ì „í™˜ì„ í†µí•´ ë‹¤ë¥¸ ë·°ê°€ ìŒ“ì´ê±°ë‚˜ Appì´ background ìƒíƒœë¡œ ë™ì‘í•˜ëŠ” ê²½ìš°, ì†Œì¼“ì„ ë‹´ë‹¹í•˜ëŠ” viewModelì´ deinitì´ ë˜ì§€ ì•Šì•„ ê³¼ë„í•œ ì†Œì¼“ í†µì‹ ì´ ì¼ì–´ë‚¬ë‹¤.
- í•´ê²° ë°©ë²•
  - í™”ë©´ ì „í™˜ì´ ì¼ì–´ë‚  ë•Œ, ì†Œì¼“ í†µì‹ ì´ ì§€ì†ì ìœ¼ë¡œ í•„ìš”í•œ ìƒí™©ê³¼ ê·¸ë ‡ì§€ ì•Šì€ ìƒí™©ì„ êµ¬ë¶„í•˜ì—¬ viewModelì´ deinit ë  ë•Œ ì´ì™¸ì—ë„ ì†Œì¼“ì„ ë‹«ê±°ë‚˜ ë³€ê²½í•˜ëŠ” ì²˜ë¦¬ë¥¼ í•´ì£¼ì—ˆë‹¤. FeedViewì—ì„œ DetailView í™”ë©´ìœ¼ë¡œ ë„˜ì–´ê°€ê²Œ ë  ë•ŒëŠ” ì†Œì¼“ í†µì‹ ì´ ëŠê¸°ì§€ ì•Šê³  ìœ ì§€ë˜ë‹¤ê°€ ìì—°ìŠ¤ëŸ½ê²Œ ë‹¤ë¥¸ í†µì‹ ìœ¼ë¡œ ì´ì–´ì ¸ì•¼ í–ˆê³ , ì•„ì˜ˆ ë‹¤ë¥¸ í™”ë©´ìœ¼ë¡œ ë„˜ì–´ê°ˆ ê²½ìš°ë‚˜ appì´ backgroundë¡œ ëŒì•„ê°ˆ ê²½ìš°ì—ëŠ” ì„ì˜ë¡œ ì†Œì¼“ ì—°ê²°ì„ ëŠì–´ ì£¼ì–´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ì™€ ê¸°ê¸°ì˜ ê³¼ë¶€í™”ë¥¼ ë°©ì§€í–ˆë‹¤.

```swift
struct FeedView: View {
    
    @StateObject
    var viewModel: FeedViewModel
    @State var searchQueryString = ""
    
    var body: some View {
        NavigationStack {
            ScrollView {
                Image(.coin)
                    .resizable()
                    .scaledToFill()
                    .clipShape(RoundedRectangle(cornerRadius: 12))
                    .frame(width: 40, height: 40)
                    .padding(.top, 4)
                
                SearchBarView(searchText: $searchQueryString)
                    .onSubmit(of: .text) {
                        viewModel.searchQuery.send(searchQueryString)
                    }
                
                LazyVStack(pinnedViews: [.sectionHeaders]) {
                    Section {
                        ForEach(viewModel.showingCoinList, id: \.id) { item in
                            NavigationLink {
                                DetailView(viewModel: DetailViewModel(coin: item))
                            } label: {
                                CoinCell(coin: item)
                                    .frame(maxWidth: .infinity)
                            }
                            Rectangle()
                                .fill(.trustGray.opacity(0.6))
                                .frame(height: 1)
                                .frame(maxWidth: 420)
                        }
                    } header: {
                        ExchangeHeader()
                            .frame(maxWidth: .infinity)
                    }
                }
                
            }
            .clipped()
            .navigationBarTitle("", displayMode: .inline)
            .onAppear {
                if !viewModel.coinList.isEmpty {
                    viewModel.manageSocket()
                }
            }
            .onDisappear {
                SocketManager.shared.closeWebSocket()
            }
        }
    }
}
```
<br>

### 2. User Interactionì´ ìˆì„ ë•Œë§ˆë‹¤ WalletView ê°ì²´ì˜ ë°°ê²½ìƒ‰ì´ ëœë¤ìœ¼ë¡œ ë³€í™”í•¨
- ë¬¸ì œ ìƒí™©
  - WalletView ë‚´ì—ì„œ User Interactionì´ ë°œìƒí•  ë•Œë§ˆë‹¤, ê°ì²´ì˜ ë°°ê²½ìƒ‰ì´ ëœë¤ìœ¼ë¡œ ë°”ë€Œì—ˆë‹¤.
- í•´ê²° ë°©ë²•
  - ê°ì²´ì˜ ë°ì´í„°ì— ëœë¤ ìƒ‰ìƒê°’ì„ ê¸°ë³¸ìœ¼ë¡œ ë„£ì–´ì£¼ì–´ ë·°ê°€ ê°±ì‹  ì‹œ ë°”ë€Œì§€ ì•Šë„ë¡ í–ˆë‹¤. SwiftUI íŠ¹ì„±ìƒ @State ë³€ìˆ˜ê°€ ë³€í™”í•  ë•Œë§ˆë‹¤ ë·°ë¥¼ ìƒˆë¡œ ê·¸ë¦¬ê²Œ ë˜ëŠ”ë°, ê¸°ì¡´ì˜ ë°©ì‹ìœ¼ë¡œëŠ” ë§¤ë²ˆ ë·°ë¥¼ ìƒˆë¡œ ê·¸ë¦´ ë•Œë§ˆë‹¤ ë°°ê²½ìƒ‰ì´ ëœë¤ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” ë¬¸ì œì˜€ë‹¤.

ì´ì „ ì½”ë“œ
```swift
        ZStack {
            RoundedRectangle(cornerRadius: 25)
                .background(Color.random())
                .fill(data.color)
                .frame(height: 150)
                .overlay {
                    Circle()
                        .fill(.white.opacity(0.3))
                        .offset(x: -120, y: -40)
                        .scaleEffect(1.6, anchor: .topLeading)
                        .frame(width: 200, height: 200)
                }
                .clipShape(RoundedRectangle(cornerRadius: 25))
        ... ...
```

ë°”ê¾¼ ì½”ë“œ
```swift
struct WalletModel: Hashable {
    let color = Color.random()
    let index: Int
    let korName: String
    let engName: String
    let marketCode: String
    var tradePrice: Double
    var change: Double
    var changePrice: Double
    var accTradePrice: Double
    
    init(index: Int, coin: CoinModel) {
        self.index = index
        self.korName = coin.korName
        self.engName = coin.engName
        self.marketCode = coin.marketCode
        self.tradePrice = coin.tradePrice
        self.change = coin.change
        self.changePrice = coin.changePrice
        self.accTradePrice = coin.accTradePrice
    }
}
```
```swift
    func cardView(_ data: WalletModel) -> some View {
        ZStack {
            RoundedRectangle(cornerRadius: 25)
                .background(Color.random())
                .fill(data.color)
                .frame(height: 150)
                .overlay {
                    Circle()
                        .fill(.white.opacity(0.3))
                        .offset(x: -120, y: -40)
                        .scaleEffect(1.6, anchor: .topLeading)
                        .frame(width: 200, height: 200)
                }
                .clipShape(RoundedRectangle(cornerRadius: 25))
    ... ...
```

<br>

### 3. API í†µì‹  ê²°ê´ê°’ì„ ìœ„ì ¯ì— ë°˜ì˜í•˜ê¸°
- ë¬¸ì œ ìƒí™©
  - API í†µì‹ ì„ í†µí•´ ë°›ì•„ì˜¨ ì½”ì¸ ë°ì´í„°ê°€ Viewì— ì œëŒ€ë¡œ ë°˜ì˜ì´ ë˜ì§€ ì•Šì•˜ë‹¤. 
ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ì„¤ì •í•œ ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì¡°ê±´ì— ì¼ì¹˜í•˜ëŠ”ì§€ ì¼ì°¨ì ìœ¼ë¡œ ìœ íš¨ì„± ê²€ì¦í•œ í›„ì—, ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ íƒ­í–ˆì„ ë•Œ ì„œë²„ í†µì‹ ì„ í†µí•´ ê°€ì… ê°€ëŠ¥í•œ ì•„ì´ë””ì¸ì§€ í™•ì¸í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•´ ì£¼ì–´ì•¼ í–ˆë‹¤. ê·¸ëŸ¬ê¸° ìœ„í•´ì„œëŠ” ìˆœì„œê°€ ì¤‘ìš”í–ˆëŠ”ë°, ì •ê·œí‘œí˜„ì‹ì„ í†µí•´ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ë¨¼ì € ê²€ì¦í•œ í›„ì— ì‚¬ìš©ìê°€ ë²„íŠ¼ì„ íƒ­í•˜ê³  ì„œë²„ í†µì‹ ì„ í†µí•´ í™•ì¸í•´ì•¼ í–ˆë‹¤.
- í•´ê²° ë°©ë²•
  - Widgetì˜ Viewë¥¼ ê·¸ë¦¬ê¸° ì „ Providerì—ì„œ í•´ë‹¹ ìœ„ì ¯ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ fetchí•œ í›„ entryë¥¼ í†µí•´ ì „ë‹¬í•´ ì£¼ì—ˆë‹¤. ì´ëŠ” Widgetì˜ íŠ¹ì„± ë•Œë¬¸ì´ì—ˆëŠ”ë°, Widgetì€ staticí•œ ìƒíƒœë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ë‚´ë¶€ì—ì„œ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ë°›ì•„ ì ìš©í•  ìˆ˜ ì—†ë‹¤.

```swif
tstruct Provider: AppIntentTimelineProvider {
    
    init() {
        getData()
    }
    
    func getData() {
        NetworkManager.shared.fetchData(api: .candleCharts(marketName: "KRW-BTC"), type: [CandleModel].self) { result in
            switch result {
            case .success(let success):
                NetworkManager.shared.candleModels = success
            case .failure(let failure):
                print("error: \(failure)")
            }
        }
    }
    
    func placeholder(in context: Context) -> SimpleEntry {
        SimpleEntry(date: Date(), configuration: ConfigurationAppIntent(), models: NetworkManager.shared.candleModels)
    }
    
    func snapshot(for configuration: ConfigurationAppIntent, in context: Context) async -> SimpleEntry {
        SimpleEntry(date: Date(), configuration: configuration, models: NetworkManager.shared.candleModels)
    }
    
    func timeline(for configuration: ConfigurationAppIntent, in context: Context) async -> Timeline<SimpleEntry> {
        var entries: [SimpleEntry] = []
        
        // Generate a timeline consisting of five entries an hour apart, starting from the current date.
        let currentDate = Date()
        for hourOffset in 0 ..< 5 {
            let entryDate = Calendar.current.date(byAdding: .hour, value: hourOffset, to: currentDate)!
            let entry = SimpleEntry(date: entryDate, configuration: configuration, models: NetworkManager.shared.candleModels)
            entries.append(entry)
        }
        return Timeline(entries: entries, policy: .atEnd)
    }
}
```


```swift
struct CoinWidgetsEntryView : View {
    var entry: Provider.Entry
    
    var body: some View {
        ZStack {
            ContainerRelativeShape()
                .fill(.white.gradient)
            VStack(alignment: .leading) {
                Text("ğŸª™ Bitcoin")
                    .font(.headline).bold()
                ChartView(candles: entry.models)
            }
            .padding()
        }
    }
}
```
<br>
